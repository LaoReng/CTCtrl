/* empty css                  *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                     */import{aS as I,av as O,a5 as Q,aZ as ee,a7 as r,aT as te,a8 as oe,aa as B,ab as le,af as v,ac as t,ad as a,ai as f,ar as s,ay as ae,aA as ne,au as se,aU as F,am as ie,aV as re,a_ as ue,aW as de,aX as pe,al as ce,ak as me,an as fe,a$ as ge,aY as ve,ao as _e,ap as be,aj as w,a3 as he}from"./index-DPIfXxtw.js";const we=n=>I.get("/getNoticeList",{params:{page:n.page,pageSize:n.pageSize}}),ye=n=>I.post("/issueNotice",{phone:n.phone,title:n.title,content:n.content,createTime:n.createTime}),Ve=n=>I.post("/updateNotice",{noticeId:n.noticeId,title:n.title,content:n.content,updateTime:n.updateTime}),Se=n=>I.delete("/deleteNotice",{data:{noticeIds:n.noticeIds}}),Ie=n=>(_e("data-v-5cd14da2"),n=n(),be(),n),xe={class:"box"},Ce={style:{padding:"20px 20px 10px"}},Ne=Ie(()=>v("span",{style:{"font-size":"20px","margin-left":"10px"}},[v("i",null,"通知列表")],-1)),Te={class:"elm-box"},ke={class:"content-cell"},De={class:"dialog-footer"},Ee={class:"dialog-footer"},$e={class:"page-box"},g="68px",ze=O({__name:"index",setup(n){const q=Q(ee),y=r(!1),V=r(!1);let k=r([{noticeId:"",admId:"",title:"",content:"",createTime:"",updateTime:""}]),D=r(),E=r(10),_=r(1),p=r({title:"",content:"",delivery:!1}),L=r(q.token),c=r({title:"",content:""}),$=r(),m=r([]),d=r(""),x=r(!1);async function S(o){try{const e=await we({page:_.value,pageSize:E.value});e.status==1?(k.value=e.data.list,D.value=e.data.total*10):console.error("API返回数据格式不符预期")}catch(e){console.error("请求失败:",e)}}te(()=>{S(_.value)});const M=o=>{_.value=o,S()};function P(o){let e="",i=0;for(const u of o)i+=1,i>=40&&(e+="<br/>",i=0),e+=u;return e}function j(o){const e=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),u=String(o.getDate()).padStart(2,"0"),C=String(o.getHours()).padStart(2,"0"),N=String(o.getMinutes()).padStart(2,"0"),T=String(o.getSeconds()).padStart(2,"0");return`${e}-${i}-${u} ${C}:${N}:${T}`}oe(()=>{const o=()=>{d.value=j(new Date)};o(),setInterval(o,1e3)});async function R(){try{(await ye({phone:L.value,title:p.value.title,content:p.value.content,createTime:d.value})).status==1?(S(_.value),w({message:"发布成功",type:"success"}),p.value.title="",p.value.content=""):w.error("发布失败")}catch(o){console.error("请求失败:",o)}}const W=()=>{R()},X=o=>{m.value=o.map(e=>e.noticeId),m.value.length>1?x.value=!0:x.value=!1,console.log(m.value),console.log(m.value.length)},Y=o=>{$.value=o.noticeId,c.value.title=o.title,c.value.content=o.content,(m.value=[])&&(m.value.push(o.noticeId),console.log(m.value))};async function H(){try{(await Ve({noticeId:$.value,title:c.value.title,content:c.value.content,updateTime:d.value})).status==1?(S(_.value),w({message:"修改成功",type:"success"})):w.error("修改失败")}catch(o){console.error("请求失败:",o)}}const Z=()=>{H()};async function z(){try{(await Se({noticeIds:m.value})).status==1?(S(_.value),w({message:"删除成功",type:"success"})):w.error("删除失败")}catch(o){console.error("请求失败:",o)}}const G=()=>{z()},J=()=>{z()};return(o,e)=>{const i=ie,u=re,C=ue,N=de,T=pe,b=ce,h=me,U=fe,A=ge,K=ve;return B(),le("div",xe,[v("div",Ce,[Ne,t(i,{class:"right",plain:"",onClick:e[0]||(e[0]=l=>V.value=!0),type:"primary",style:{float:"right",background:"rgb(64, 158, 255)",color:"white"}},{default:a(()=>[f("发布通知")]),_:1}),s(x)?(B(),ae(i,{key:0,class:"right",type:"danger",onClick:J},{default:a(()=>[f("批量删除")]),_:1})):ne("",!0)]),v("div",Te,[t(T,{data:s(k),style:{width:"100%","margin-top":"-10px"},onRowClick:Y,onSelectionChange:X},{default:a(()=>[t(u,{fixed:"left",type:"selection",width:"55"}),t(u,{prop:"noticeId",label:"通知ID",width:"100","show-overflow-tooltip":""}),t(u,{prop:"admId",label:"管理员ID",width:"110","show-overflow-tooltip":""}),t(u,{prop:"title",label:"标题",width:"180","show-overflow-tooltip":""}),t(u,{prop:"content",label:"内容"},{default:a(l=>[t(C,{effect:"dark","hide-after":10,"raw-content":!0,content:P(l.row.content),placement:"top"},{default:a(()=>[v("div",ke,se(l.row.content),1)]),_:2},1032,["content"])]),_:1}),t(u,{prop:"createTime",label:"创建时间",width:"180","show-overflow-tooltip":""}),t(u,{prop:"updateTime",label:"更新时间",width:"180","show-overflow-tooltip":""}),t(u,{fixed:"right",label:"         操作",width:"135"},{default:a(()=>[t(i,{plain:"",onClick:e[1]||(e[1]=l=>y.value=!0),type:"primary",size:"small"},{default:a(()=>[f("修改")]),_:1}),t(N,{width:"220","confirm-button-text":"确定","cancel-button-text":"不了",title:"你确定要删除此用户吗?",onConfirm:e[2]||(e[2]=l=>G())},{reference:a(()=>[t(i,{type:"danger",size:"small"},{default:a(()=>[f("删除")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),t(A,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=l=>y.value=l),title:"通知修改","label-width":g,width:"500",draggable:""},{footer:a(()=>[v("div",De,[t(i,{onClick:e[6]||(e[6]=l=>y.value=!1)},{default:a(()=>[f("取消")]),_:1}),t(i,{type:"primary",onClick:e[7]||(e[7]=l=>(y.value=!1,Z()))},{default:a(()=>[f(" 修改 ")]),_:1})])]),default:a(()=>[t(U,{model:s(c)},{default:a(()=>[t(h,{label:"标题",prop:"title","label-width":g,required:""},{default:a(()=>[t(b,{autocomplete:"off",modelValue:s(c).title,"onUpdate:modelValue":e[3]||(e[3]=l=>s(c).title=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"内容",prop:"content","label-width":g,required:""},{default:a(()=>[t(b,{type:"textarea",autocomplete:"off",modelValue:s(c).content,"onUpdate:modelValue":e[4]||(e[4]=l=>s(c).content=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"更新时间","label-width":g},{default:a(()=>[t(b,{modelValue:s(d),"onUpdate:modelValue":e[5]||(e[5]=l=>F(d)?d.value=l:d=l),autocomplete:"off",disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(A,{modelValue:V.value,"onUpdate:modelValue":e[14]||(e[14]=l=>V.value=l),title:"通知发布","label-width":g,width:"500",draggable:""},{footer:a(()=>[v("div",Ee,[t(i,{onClick:e[12]||(e[12]=l=>V.value=!1)},{default:a(()=>[f("取消")]),_:1}),t(i,{type:"primary",onClick:e[13]||(e[13]=l=>(V.value=!1,W()))},{default:a(()=>[f(" 发布 ")]),_:1})])]),default:a(()=>[t(U,{data:s(p)},{default:a(()=>[t(h,{label:"标题",prop:"title","label-width":g,required:""},{default:a(()=>[t(b,{autocomplete:"off",modelValue:s(p).title,"onUpdate:modelValue":e[9]||(e[9]=l=>s(p).title=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"内容",prop:"content","label-width":g,required:""},{default:a(()=>[t(b,{type:"textarea",autocomplete:"off",modelValue:s(p).content,"onUpdate:modelValue":e[10]||(e[10]=l=>s(p).content=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"发布时间","label-width":g},{default:a(()=>[t(b,{modelValue:s(d),"onUpdate:modelValue":e[11]||(e[11]=l=>F(d)?d.value=l:d=l),autocomplete:"off",disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])]),v("div",$e,[t(K,{class:"page","page-size":s(E),"current-page":s(_),layout:"prev, pager, next, jumper",total:s(D),onCurrentChange:M},null,8,["page-size","current-page","total"])])])}}}),Pe=he(ze,[["__scopeId","data-v-5cd14da2"]]);export{Pe as default};
